
########## prefix
# bind-key -r C-b send-prefix


########## remap prefix
# set -g prefix C-a
# unbind-key C-b
# bind-key C-a send-prefix
# bind-key -r C-a send-prefix


########## version
# run-shell 'tmux setenv -g TMUX_VERSION $(tmux -V | sed "s/^tmux //")'


########## reload
bind-key R source-file $HOME/.tmux.conf \; display-message "$HOME/.tmux.conf reloaded!"
bind-key C-r source-file $HOME/.tmux.conf \; display-message "$HOME/.tmux.conf reloaded!"


########## options
### terminal
set-option -s default-terminal 'screen-256color'
# Override terminal so it displays 32bit RGB color
set-option -a terminal-overrides ",*256col*:RGB"
set-option -gw xterm-keys on
# set-option -g default-shell /bin/bash
set-option -g focus-events on
### delay
# set-option -g display-time 2000
# set-option -g display-panes-time 2000
# set-option -g repeat-time 500
### history
set-option -g history-limit 50000
### server
# set-option -s escape-time 1
set-option -s escape-time 100
### window
set-option -g aggressive-resize off
set-option -g automatic-rename on
set-option -g base-index 1
set-option -g renumber-windows on
# set-option -g clock-mode-colour red
set-option -g clock-mode-colour "#00afff"
set-option -g clock-mode-style 24
### pane
set-option -w -g pane-base-index 1
### keys
set-option -w -g mode-keys emacs
# set-option -w -g mode-keys vi

########## options :: layout
set-option -g message-style bg=yellow,fg=black
# set-option -g message-style bg=cyan,fg=black
set-option -w -g pane-border-lines single   # single, double, heavy, simple, number
if-shell 'tmux -V | grep -q -E "^tmux (3\.[4-9]|[4-9]\.)"' {
set-option -w -g pane-border-indicators arrows   # off, colour, arrows, both
}
set-option -w -g pane-border-status off   # off, top, bottom
set-option -w -g pane-border-style fg=default,bg=#111111
set-option -w -g pane-active-border-style fg=yellow,bg=#111111
set-option -g window-style 'fg=default,bg=#282828'
set-option -g window-active-style 'fg=default,bg=terminal'

########## options :: status
set-option -g status on
set-option -g status-interval 15
set-option -g status-keys emacs
#
set-option -g status-position bottom   # top, bottom
set-option -g status-style default   # none, default
set-option -g status-left-length 30   # default: 10
set-option -g status-right-length 60   # default: 40
set-option -g status-justify left   # left, centre, right, absolute-centre
set-option -g status-bg '#333333'
set-option -g status-fg '#cccccc'
set-option -w -g window-status-style fg=default,bg=default
set-option -w -g window-status-current-style "fg=yellow,bold,bg=default"
#
# set-option -g status-left ' [#[bold]#S:#I.#P#[default] '
set-option -g status-left ' ‚ù∞ #[bold]#S:#I.#P#[default] ‚ù±  '
# set-option -g status-left '‚ñê #[bold]#S:#I.#P#[default] ‚ñå  '
# set-option -g status-left '„Äê #[bold]#S:#I.#P#[default] „Äë '
# set-option -g status-right "#[fg=cyan]%d %b %R"
# set-option -g status-right "#[fg=purple]#(~/battery Discharging) | #[fg=cyan]%d %b %R"
# set-option -g status-right ' [%Y-%m-%d %H:%M:%S] [#(whoami)@#h]'
# set-option -g status-right '#(load_avg -t " %%s ")#(battery -t " %%s ") üïí%H:%M:%S  üíª#(whoami)@#h '
set-option -g status-right '#(load_avg_status -t)#(battery_status -t)#(uptime_status -t) üïí%H:%M:%S  üíª#{USER}@#{host_short} '

########## options :: notification
set-option -w -g monitor-activity off
set-option -w -g visual-activity off
set-option -g visual-bell off
set-option -g visual-silence off
# set-option -g bell-action none


########## binding
### config
# bind-key = customize-mode -Z
### pane
bind-key -n M-Left select-pane -L
bind-key -n M-Right select-pane -R
bind-key -n M-Up select-pane -U
bind-key -n M-Down select-pane -D
unbind-key -T copy-mode M-Left
unbind-key -T copy-mode M-Right
unbind-key -T copy-mode M-Up
unbind-key -T copy-mode M-Down
# unbind-key -T copy-mode M-S-Left
# unbind-key -T copy-mode M-S-Right
# unbind-key -T copy-mode M-S-Up
# unbind-key -T copy-mode M-S-Down
bind-key -r o select-pane -t :.+
bind-key -r O select-pane -t :.-
bind-key b break-pane -d
bind-key q display-panes -bN -d 3000
# bind-key C-s set-window-option synchronize-panes\; display-message "synchronize-panes is now #{?pane_synchronized,on,off}"
bind-key = set-window-option synchronize-panes\; display-message "synchronize-panes is now #{?pane_synchronized,on,off}"
bind-key * run-shell -b "tmux display-panes -N -d 5000" \; command-prompt -p 'pane #: ' { swap-pane -t '%%' }
bind-key + command-prompt -p 'join pane from: ' "join-pane -h -s '%%'"   # -T target
bind-key M-+ command-prompt -p 'move pane to: ' "join-pane -h -t '%%'"   # -T Target
### window
# bind-key -r p select-window -t :-
# bind-key -r n select-window -t :+
bind-key _ split-window -v
bind-key - split-window -v -c '#{pane_current_path}'
bind-key | split-window -h
bind-key \\ split-window -h -c '#{pane_current_path}'
bind-key / new-window -c '#{pane_current_path}'
bind-key -r < swap-window -d -t -1
bind-key -r > swap-window -d -t +1
bind-key 0 select-window -t :=10
# bind-key k confirm-before -p "kill-window #W? (y/n)" kill-window
# bind-key _ command-prompt -p "move window to: " "move-window -t '%%'"
### session
bind-key C-s command-prompt -p 'session name: ' "new -A -s '%%' -c '#{pane_current_path}'"
bind-key C-a send-keys 'atx' 'C-m'
bind-key C-n switch-client -n
bind-key C-p switch-client -p
bind-key C-l switch-client -l
bind-key C-k confirm-before -p "kill-session #S? (y/n)" kill-session
bind-key C-x run-shell 'tmux switch-client -l \; kill-session -t "$(tmux display-message -p "#S")" || tmux kill-session'
#
bind-key S command-prompt -p 'session name: ' "new -A -s '%%' -c '#{pane_current_path}'"
bind-key A send-keys 'atx' 'C-m'
bind-key N switch-client -n
bind-key P switch-client -p
bind-key L switch-client -l
bind-key K confirm-before -p "kill-session #S? (y/n)" kill-session
bind-key X run-shell 'tmux switch-client -l \; kill-session -t "$(tmux display-message -p "#S")" || tmux kill-session'
### layout
bind-key M-\# select-layout main-horizontal-mirrored
bind-key M-\$ select-layout main-vertical-mirrored
bind-key M-6 run-shell "~/.tmux/scripts/resize-adaptable.sh -l main-vertical -p 67"
bind-key M-7 run-shell "~/.tmux/scripts/resize-adaptable.sh -l main-vertical -p 33"
bind-key M-8 run-shell "~/.tmux/scripts/resize-adaptable.sh -l main-horizontal -p 67"
bind-key M-9 run-shell "~/.tmux/scripts/resize-adaptable.sh -l main-horizontal -p 33"
bind-key M-- select-layout -o
unbind-key Space
bind-key M-q split-window -d -h -c '#{pane_current_path}' -t .1 -l 67% \; split-window -d -v -c '#{pane_current_path}' -t .1 -l 67% \; select-pane -t .3
bind-key M-w split-window -d -h -c '#{pane_current_path}'\; split-window -d -h -c '#{pane_current_path}'\; select-layout even-horizontal
bind-key M-e split-window -d -h -c '#{pane_current_path}' -t .1 -l 33% \; split-window -d -v -c '#{pane_current_path}' -t .2 -l 67% \; select-pane -t .1
bind-key M-a split-window -d -h -c '#{pane_current_path}' -t .1 -l 67% \; split-window -d -v -c '#{pane_current_path}' -t .1 -l 50% \; select-pane -t .3
bind-key M-s split-window -d -h -c '#{pane_current_path}'\; split-window -d -h -c '#{pane_current_path}'\; select-layout even-horizontal
bind-key M-d split-window -d -h -c '#{pane_current_path}' -t .1 -l 33% \; split-window -d -v -c '#{pane_current_path}' -t .2 -l 50% \; select-pane -t .1

### choose
# bind-key s choose-tree -Zs -O name
# bind-key w choose-tree -Zw -O name

### buffer
# bind-key B choose-buffer
# bind-key P pipe-pane -o "cat >> ~/.log/tmux_#h_#S:#I.#P__#W.log" \; display "Toggled logging to ~/.log/tmux_#h_#S:#I.#P__#W.log"

### menu
bind-key C-q {
  display-menu -T "Session" -x C -y C \
    "New Session" c 'command-prompt -p "session name: " "new -A -s \"%%\" -c \"#{pane_current_path}\""' \
}
bind-key C-w {
  display-menu -T "Window" -x C -y C \
    "Window" / 'new-window -c "#{pane_current_path}"' \
}
bind-key C-e {
  display-menu -T "Pane" -x C -y C \
    "Pane |" | 'split-window -h -c "#{pane_current_path}"' \
    "Pane -" - 'split-window -v -c "#{pane_current_path}"' \
}
bind-key C-d {
  display-menu -T "Buffer" -x C -y C \
    "Choose buffer" b "choose-buffer" \
    "Choose buffer (Z)" B "choose-buffer -Z" \
    "Load file to buffer" l 'command-prompt -p "Load buffer from file:" "load-buffer %1"' \
    "Save buffer to file" s 'command-prompt -p "Save buffer to file:" "save-buffer %1"' \
    "Toggle pane logging" p '"cat >> ~/.log/tmux_#h_#S:#I.#P__#W.log" \; display "Toggled logging to ~/.log/tmux_#h_#S:#I.#P__#W.log"' \
}

### popup
# bind-key T display-popup -d "~/" -x C -y C -w 50% -h 50% -e "POPUP=true" -E "/bin/sh -l"
### menu
# bind-key M {
#   display-menu -T "Quick Menu" -x C -y C \
#     "New Window" n "new-window" \
#     "Horizontal Split" - "split-window" \
#     "Vertical Split"  | "split-window -h" \
#     "Close Pane" x "kill-pane"
# }


########## command
bind-key M-t split-window -h -c ~/ 'btop || htop || top'
bind-key M-s split-window -v -c ~/ 'watch -n 10 sensors'
bind-key M-e split-window -h -c ~/ 'e'
bind-key M-l split-window -h -c ~/ 'egenda'


########## vi :: binding
### pane
# bind-key h select-pane -L
# bind-key j select-pane -D
# bind-key k select-pane -U
# bind-key l select-pane -R
# bind-key -r C-h select-window -t :.-
# bind-key -r C-l select-window -t :.+
# bind-key -r H resize-pane -L 5
# bind-key -r J resize-pane -D 5
# bind-key -r K resize-pane -U 5
# bind-key -r L resize-pane -R 5


########## hook
### help
# set-hook [-g]         create hook
# show-hooks            show hooks for the current session
# show-hooks -g         show hooks for the global context
# show-hooks -g -w      show hooks related to windows


########## mouse
set-option -g mouse off


########## specific conf
if-shell "[ `uname` = Linux ]" "source-file ~/.tmux/tmux.linux.conf"
if-shell "[ `uname` = Darwin ]" "source-file ~/.tmux/tmux.mac.conf"
if-shell "[ `uname` = FreeBSD ]" "source-file ~/.tmux/tmux.freebsd.conf"
if-shell "[ -f ~/.tmux/tmux.local.conf ]" "source ~/.tmux/tmux.local.conf"


########## plugins
# install:
# git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm
#
# set-option -g @plugin 'tmux-plugins/tpm'
# set-option -g @plugin 'tmux-plugins/tmux-sensible'
# set-option -g @plugin 'tmux-plugins/tmux-resurrect'
# run-shell '~/.tmux/plugins/tpm/tpm'


########## test
# bind-key C-t send-keys 'test' 'C-m'


########## help !
### all available commands
#> tmux list-commands
#> tmux list-commands | grep pane (to search pane related commands)
### list all key bindings (live)
#> tmux list-keys
### list all bindings
#> <prefix> ?
### dump current conf
#> tmux show-options -s
#> tmux show-options -g
#> tmux show-options -A <option>
